(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[954],{10308:(e,t,r)=>{"use strict";r.d(t,{J:()=>i});var o=r(12115),a=r(56166);function i(){let e=o.useContext(a.Rs);if(!e)throw Error("useUser must be used within a UserProvider");return e}},20660:(e,t,r)=>{"use strict";r.d(t,{f:()=>o});let o={home:"/",auth:{signIn:"/auth/sign-in"},dashboard:{dashboard:"/dashboard",queryLog:"/dashboard/query-log",upstreamServers:"/dashboard/upstream-servers",clients:"/dashboard/clients",settings:"/dashboard/settings",log:"/dashboard/log",term:"/dashboard/term"},errors:{notFound:"/errors/not-found"}}},31265:(e,t,r)=>{"use strict";r.d(t,{s:()=>v});var o=r(95155),a=r(12115),i=r(41983),l=r(79010),n=r(39504),s=r(56798),d=r(4647),c=r(98521),u=r(15712);function v(){let{setColorScheme:e}=(0,l.Ut)(),t=(0,u.A)("(prefers-color-scheme: dark)"),[r,v]=a.useState("system"),m=a.useCallback(r=>{let o=r,a=r;"system"!==r&&"dark"!==r&&"light"!==r&&(a="system"),"system"===a&&(o=t?"dark":"light"),v(a),e(o)},[t,e]);return a.useEffect(()=>{let e=localStorage.getItem("user-color-scheme");m(null!=e?e:"system")},[t,e,m]),(0,o.jsx)(c.i,{children:(0,o.jsxs)(i.A,{sx:{ml:1},onClick:()=>{let e;e="system"===r?"dark":"dark"===r?"light":"system",localStorage.setItem("user-color-scheme",e),m(e)},children:["light"===r&&(0,o.jsx)(n.A,{}),"dark"===r&&(0,o.jsx)(s.A,{}),"system"===r&&(0,o.jsx)(d.A,{})]})})}},67570:(e,t,r)=>{"use strict";r.d(t,{gu:()=>l,lN:()=>n});var o=r(95155);r(12115);var a=r(94049),i=r(98521);function l(e){let{color:t="dark",emblem:r,height:i=60,width:l=60}=e;return(0,o.jsx)(a.default,{alt:"logo",component:"img",height:i,src:"/assets/logo.svg",width:l})}function n(e){let{country:t,alt:r,height:l="auto",width:n="auto",title:s}=e;return(0,o.jsxs)(i.i,{children:[(0,o.jsx)(a.default,{alt:r,component:"img",height:l,src:"/assets/flags/".concat(t,".svg"),width:n,sx:{display:"inline-block",verticalAlign:"middle"}}),s?(0,o.jsx)("span",{style:{marginLeft:"8px"},children:s}):null]})}},69044:(e,t,r)=>{"use strict";r.d(t,{AuthGuard:()=>c});var o=r(95155),a=r(12115),i=r(20063),l=r(22003),n=r(20660),s=r(49900),d=r(10308);function c(e){let{children:t}=e,r=(0,i.useRouter)(),{user:c,error:u,isLoading:v}=(0,d.J)(),[m,h]=a.useState(!0),x=async()=>{if(!v){if(u)return void h(!1);if(!c){s.v.debug("[AuthGuard]: User is not logged in, redirecting to sign in"),r.replace(n.f.auth.signIn);return}h(!1)}};return(a.useEffect(()=>{x().catch(()=>{})},[c,u,v]),m)?null:u?(0,o.jsx)(l.A,{severity:"error",children:u}):(0,o.jsx)(a.Fragment,{children:t})}},83870:(e,t,r)=>{Promise.resolve().then(r.bind(r,57019)),Promise.resolve().then(r.bind(r,69044)),Promise.resolve().then(r.bind(r,89898))},89898:(e,t,r)=>{"use strict";r.d(t,{default:()=>M});var o=r(95155),a=r(12115),i=r(94049),l=r(97322),n=r(8106),s=r(25635),d=r(85483),c=r(32683),u=r(24274);function v(){let{t:e}=(0,u.Bd)();return(0,o.jsxs)(s.default,{variant:"body2",color:"textSecondary",align:"center",children:[e("Copyright")," \xa9 ",new Date().getFullYear()," ",e("Nick Peng. All rights reserved.")]})}function m(){let[e,t]=a.useState(null),[r,i]=a.useState(null),{t:l}=(0,u.Bd)();return a.useEffect(()=>{n.Y.GetVersion().then(e=>{var r,o,a,l;if(e.error)return;let n=null!=(a=null==(r=e.data)?void 0:r.smartdns)?a:null,s=null!=(l=null==(o=e.data)?void 0:o.smartdns_ui)?l:null;t(n),i(s)}).catch(e=>{})},[r,e]),(0,o.jsxs)(s.default,{variant:"body2",color:"textSecondary",align:"center",sx:{fontSize:"0.70rem","@media (min-width: 600px)":{textAlign:"right"}},children:[l("UI Version"),": ",r,(0,o.jsx)("br",{}),l("Server Version"),": ",e]})}function h(){let{t:e}=(0,u.Bd)();return(0,o.jsxs)(d.default,{direction:"row",spacing:4,children:[(0,o.jsx)(c.A,{href:"https://pymumu.github.io/smartdns",color:"inherit",children:e("Official Site")}),(0,o.jsx)(c.A,{href:"https://github.com/pymumu/smartdns",color:"inherit",children:e("Source")}),(0,o.jsx)(c.A,{href:"https://github.com/pymumu/smartdns/issues",color:"inherit",children:e("Issues")})]})}function x(){return(0,o.jsxs)(i.default,{component:"header",sx:{borderBottom:"1px solid var(--mui-palette-divider)",position:"sticky",top:0,zIndex:"var(--mui-zIndex-appBar)",mt:"auto"},children:[(0,o.jsxs)(d.default,{direction:"column",spacing:2,sx:{alignItems:"center",justifyContent:"space-between",minHeight:"20px",px:4,"@media (min-width: 600px)":{flexDirection:"row",pb:0}},children:[(0,o.jsx)(d.default,{children:(0,o.jsx)(v,{})}),(0,o.jsx)(d.default,{children:(0,o.jsx)(h,{})})]}),(0,o.jsx)(d.default,{sx:{px:4},children:(0,o.jsx)(m,{})})]})}var p=r(41983),f=r(52619),g=r.n(f),b=r(20063),j=r(21067),I=r(13315),y=r(20660);function k(e){let{disabled:t,external:r,href:o,matcher:a,pathname:i}=e;return!t&&!!o&&!r&&(a?"startsWith"===a.type?i.startsWith(a.href):"equals"===a.type&&i===a.href:i===o)}var N=r(67570);let S=[{key:"dashboard",title:"Dashboard",href:y.f.dashboard.dashboard,icon:"QueryStats"},{key:"query-log",title:"Query Log",href:y.f.dashboard.queryLog,icon:"EventNote"},{key:"upstream-servers",title:"Upstream Servers",href:y.f.dashboard.upstreamServers,icon:"Dns"},{key:"devices",title:"Clients",href:y.f.dashboard.clients,icon:"Devices"},{key:"log",title:"Log",href:y.f.dashboard.log,icon:"Article"},{key:"term",title:"Terminal",href:y.f.dashboard.term,icon:"Terminal"},{key:"settings",title:"Settings",href:y.f.dashboard.settings,icon:"Settings"}];var A=r(24458),w=r(87863),C=r(12388),D=r(97768),B=r(68445),z=r(39728),E=r(14821);let P={QueryStats:A.A,EventNote:w.A,Dns:C.A,Devices:D.A,Article:B.A,Settings:z.A,Terminal:E.A};var W=r(10308);function _(e){let{open:t,onClose:r,onActiveItem:a,OnClickItem:l}=e,n=(0,b.usePathname)();return(0,o.jsxs)(I.Ay,{PaperProps:{sx:{"--SideNav-background":"var(--mui-palette-toolbar-background)","--SideNav-color":"var(--mui-palette-toolbar-color)","--NavItem-color":"var(--mui-palette-toolbar-navItem-color)","--NavItem-hover-background":"var(--mui-palette-toolbar-navItem-hoverBackground)","--NavItem-active-background":"var(--mui-palette-toolbar-navItem-activeBackground)","--NavItem-active-color":"var(--mui-palette-toolbar-navItem-activeColor)","--NavItem-disabled-color":"var(--mui-palette-toolbar-navItem-disabledColor)","--NavItem-icon-color":"var(--mui-palette-toolbar-navItem-iconColor)","--NavItem-icon-active-color":"var(--mui-palette-toolbar-navItem-iconActiveColor)","--NavItem-icon-disabled-color":"var(--mui-palette-toolbar-navItem-iconDisabledColor)",bgcolor:"var(--SideNav-background)",color:"var(--SideNav-color)",display:"flex",flexDirection:"column",maxWidth:"100%",scrollbarWidth:"none",width:"var(--MobileNav-width)",zIndex:"var(--MobileNav-zIndex)","&::-webkit-scrollbar":{display:"none"}}},onClose:r,open:t,children:[(0,o.jsxs)(d.default,{spacing:2,sx:{p:2,alignItems:"center"},direction:"row",children:[(0,o.jsx)(i.default,{component:g(),href:y.f.home,sx:{display:"inline-flex"},children:(0,o.jsx)(N.gu,{color:"light",height:64,width:64})}),(0,o.jsx)(s.default,{variant:"h5",children:"SmartDNS"})]}),(0,o.jsx)(j.A,{sx:{borderColor:"var(--mui-palette-divider)"}}),(0,o.jsx)(i.default,{component:"nav",sx:{flex:"1 1 auto",p:"12px"},children:(0,o.jsx)(O,{onActiveItem:a,OnClickItem:l,pathname:n,items:S})}),(0,o.jsx)(j.A,{sx:{borderColor:"var(--mui-palette-divider)"}})]})}function O(e){let{onActiveItem:t,OnClickItem:r,items:a=[],pathname:i}=e,{t:l}=(0,u.Bd)(),{user:n}=(0,W.J)(),s=a.reduce((e,a)=>{let{key:s,title:d="",...c}=a;if(n&&n.sideNavVisibility.has(s)&&!0!==n.sideNavVisibility.get(s))return e.push(null),e;e.push((0,o.jsx)(V,{OnClickItem:r,pathname:i,title:l(d),...c},s));let{disabled:u,external:v,href:m,matcher:h}=a;return k({disabled:u,external:v,href:m,matcher:h,pathname:i})&&t&&t(a),e},[]);return(0,o.jsx)(d.default,{component:"ul",spacing:1,sx:{listStyle:"none",m:0,p:0},children:s})}function V(e){let{OnClickItem:t,disabled:r,external:a,href:l,icon:n,matcher:d,pathname:c,title:u}=e,v=k({disabled:r,external:a,href:l,matcher:d,pathname:c}),m=n?P[n]:null;return(0,o.jsx)("li",{children:(0,o.jsx)("div",{children:(0,o.jsxs)(i.default,{...l?{component:a?"a":g(),href:l,target:a?"_blank":void 0,rel:a?"noreferrer":void 0}:{role:"button"},onClick:()=>{t&&t(e)},sx:{alignItems:"center",borderRadius:1,color:"var(--NavItem-color)",cursor:"pointer",display:"flex",flex:"0 0 auto",gap:1,p:"6px 16px",position:"relative",textDecoration:"none",whiteSpace:"nowrap",...r&&{bgcolor:"var(--NavItem-disabled-background)",color:"var(--NavItem-disabled-color)",cursor:"not-allowed"},...v&&{bgcolor:"var(--NavItem-active-background)",color:"var(--NavItem-active-color)"}},children:[(0,o.jsx)(i.default,{sx:{alignItems:"center",display:"flex",justifyContent:"center",flex:"0 0 auto"},children:m?(0,o.jsx)(m,{}):null}),(0,o.jsx)(i.default,{sx:{flex:"1 1 auto"},children:(0,o.jsx)(s.default,{component:"span",sx:{color:"inherit",fontSize:"0.875rem",fontWeight:500,lineHeight:"28px"},children:u})})]})})})}var U=r(3596),q=r(49900),F=r(31265),H=r(70787);function J(){let{checkSession:e}=(0,W.J)(),t=(0,b.useRouter)(),r=a.useCallback(async()=>{try{let{error:r}=await U.y.signOut();if(r)return void q.v.error("Sign out error",r);await (null==e?void 0:e()),t.refresh()}catch(e){q.v.error("Sign out error",e)}},[e,t]);return(0,o.jsxs)(d.default,{direction:"row",spacing:2,children:[(0,o.jsx)(F.s,{}),(0,o.jsx)(p.A,{onClick:async()=>{await r()},children:(0,o.jsx)(H.A,{})})]})}var L=r(53718);function R(e){let{pageTitle:t}=e,[r,l]=a.useState(!1);return(0,o.jsxs)(a.Fragment,{children:[(0,o.jsx)(i.default,{component:"header",sx:{color:"var(--mui-palette-toolbar-title-color)",borderBottom:"1px solid var(--mui-palette-divider)",backgroundColor:"var(--mui-palette-toolbar-title-background)",position:"sticky",top:0,zIndex:"var(--mui-zIndex-appBar)"},children:(0,o.jsxs)(d.default,{direction:"row",spacing:2,sx:{alignItems:"center",justifyContent:"space-between",minHeight:"64px",px:2},children:[(0,o.jsxs)(d.default,{sx:{alignItems:"center"},direction:"row",spacing:2,children:[(0,o.jsx)(p.A,{onClick:()=>{l(!0)},sx:{display:{lg:"none"}},children:(0,o.jsx)(L.A,{})}),(0,o.jsx)(d.default,{children:(0,o.jsx)(s.default,{variant:"h5",children:t})})]}),(0,o.jsx)(J,{})]})}),(0,o.jsx)(_,{onClose:()=>{l(!1)},open:r,OnClickItem:()=>{l(!1)}})]})}function T(e){let{onActiveItem:t}=e,r=(0,b.usePathname)();return(0,o.jsxs)(i.default,{sx:{"--SideNav-background":"var(--mui-palette-toolbar-background)","--SideNav-color":"var(--mui-palette-toolbar-color)","--SideNav-title-color":"var(--mui-palette-toolbar-title-color)","--SideNav-title-background":"var(--mui-palette-toolbar-title-background)","--NavItem-color":"var(--mui-palette-toolbar-navItem-color)","--NavItem-hover-background":"var(--mui-palette-toolbar-navItem-hoverBackground)","--NavItem-active-background":"var(--mui-palette-toolbar-navItem-activeBackground)","--NavItem-active-color":"var(--mui-palette-toolbar-navItem-activeColor)","--NavItem-disabled-color":"var(--mui-palette-toolbar-navItem-disabledColor)","--NavItem-icon-color":"var(--mui-palette-toolbar-navItem-iconColor)","--NavItem-icon-active-color":"var(--mui-palette-toolbar-navItem-iconActiveColor)","--NavItem-icon-disabled-color":"var(--mui-palette-toolbar-navItem-iconDisabledColor)",bgcolor:"var(--SideNav-background)",color:"var(--SideNav-color)",display:{xs:"none",lg:"flex"},flexDirection:"column",height:"100%",left:0,maxWidth:"100%",position:"fixed",scrollbarWidth:"none",top:0,width:"var(--SideNav-width)",zIndex:"var(--SideNav-zIndex)","&::-webkit-scrollbar":{display:"none"}},children:[(0,o.jsxs)(d.default,{spacing:2,sx:{p:3,alignItems:"center"},direction:"row",children:[(0,o.jsx)(i.default,{component:g(),href:y.f.home,sx:{display:"inline-flex"},children:(0,o.jsx)(N.gu,{color:"light",height:64,width:64})}),(0,o.jsx)(s.default,{variant:"h5",children:"SmartDNS"})]}),(0,o.jsx)(j.A,{sx:{borderColor:"var(--mui-palette-divider)"}}),(0,o.jsx)(i.default,{component:"nav",sx:{flex:"1 1 auto",p:"12px"},children:(0,o.jsx)(G,{onActiveItem:t,pathname:r,items:S})}),(0,o.jsx)(j.A,{sx:{borderColor:"var(--mui-palette-divider)"}})]})}function G(e){let{onActiveItem:t,items:r=[],pathname:a}=e,{t:i}=(0,u.Bd)(),{user:l}=(0,W.J)(),n=r.reduce((e,r)=>{let{key:n,title:s="",...d}=r;if(l&&l.sideNavVisibility.has(n)&&!0!==l.sideNavVisibility.get(n))return e.push(null),e;e.push((0,o.jsx)(Q,{pathname:a,title:i(s),...d},n));let{disabled:c,external:u,href:v,matcher:m}=r;return k({disabled:c,external:u,href:v,matcher:m,pathname:a})&&t&&r&&t(r),e},[]);return(0,o.jsx)(d.default,{component:"ul",spacing:1,sx:{listStyle:"none",m:0,p:0},children:n})}function Q(e){let{disabled:t,external:r,href:a,icon:l,matcher:n,pathname:d,title:c}=e,u=k({disabled:t,external:r,href:a,matcher:n,pathname:d}),v=l?P[l]:null;return(0,o.jsx)("li",{children:(0,o.jsxs)(i.default,{...a?{component:r?"a":g(),href:a,target:r?"_blank":void 0,rel:r?"noreferrer":void 0}:{role:"button"},sx:{alignItems:"center",borderRadius:1,color:"var(--NavItem-color)",cursor:"pointer",display:"flex",flex:"0 0 auto",gap:1,p:"6px 16px",position:"relative",textDecoration:"none",whiteSpace:"nowrap",...t&&{bgcolor:"var(--NavItem-disabled-background)",color:"var(--NavItem-disabled-color)",cursor:"not-allowed"},...u&&{bgcolor:"var(--NavItem-active-background)",color:"var(--NavItem-active-color)"}},children:[(0,o.jsx)(i.default,{sx:{alignItems:"center",display:"flex",justifyContent:"center",flex:"0 0 auto"},children:v?(0,o.jsx)(v,{}):null}),(0,o.jsx)(i.default,{sx:{flex:"1 1 auto"},children:(0,o.jsx)(s.default,{component:"span",sx:{color:"inherit",fontSize:"0.875rem",fontWeight:500,lineHeight:"28px"},children:c})})]})})}function M(e){let{children:t}=e,[r,n]=a.useState(""),{t:s}=(0,u.Bd)();return(0,o.jsxs)(i.default,{sx:{bgcolor:"var(--mui-palette-background-default)",display:"flex",flexDirection:"column",position:"relative",minHeight:"100%"},children:[(0,o.jsx)(T,{onActiveItem:function(e){a.useEffect(()=>{e.title&&n(s(e.title))},[s,e.title])}}),(0,o.jsxs)(i.default,{sx:{display:"flex",flex:"1 1 auto",flexDirection:"column",pl:{lg:"var(--SideNav-width)"}},children:[(0,o.jsx)(R,{pageTitle:r}),(0,o.jsx)(l.A,{maxWidth:!1,sx:{py:"32px"},children:t}),(0,o.jsx)(x,{})]})]})}},98521:(e,t,r)=>{"use strict";r.d(t,{i:()=>l});var o=r(95155),a=r(12115),i=r(89255);function l(e){let{children:t,defer:r=!1,fallback:l=null}=e,[n,s]=a.useState(!1);return(0,i.A)(()=>{r||s(!0)},[r]),a.useEffect(()=>{r&&s(!0)},[r]),(0,o.jsx)(a.Fragment,{children:n?t:l})}}},e=>{e.O(0,[393,319,169,190,107,217,10,247,558,166,441,255,358],()=>e(e.s=83870)),_N_E=e.O()}]);