(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[236],{10308:(e,t,n)=>{"use strict";n.d(t,{J:()=>o});var r=n(12115),a=n(56166);function o(){let e=r.useContext(a.Rs);if(!e)throw Error("useUser must be used within a UserProvider");return e}},11789:(e,t,n)=>{"use strict";n.d(t,{Dg:()=>s,Dp:()=>l}),n(12115);var r=n(33065),a=n(57019),o=n(95155);function l(e){return function(t){return(0,o.jsx)(a.default,{styles:"function"==typeof e?n=>e({theme:n,...t}):e})}}function s(){return r.A}},15712:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var r=n(12115),a=n.t(r,2),o=n(89255),l=n(19868),s=n(9027);let i={...a}.useSyncExternalStore;function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{themeId:t}=e;return function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=(0,s.A)();a&&t&&(a=a[t]||a);let c="undefined"!=typeof window&&void 0!==window.matchMedia,{defaultMatches:u=!1,matchMedia:d=c?window.matchMedia:null,ssrMatchMedia:f=null,noSsr:h=!1}=(0,l.A)({name:"MuiUseMediaQuery",props:n,theme:a}),m="function"==typeof e?e(a):e;return(m=m.replace(/^@media( ?)/m,"")).includes("print")&&console.warn("MUI: You have provided a `print` query to the `useMediaQuery` hook.\nUsing the print media query to modify print styles can lead to unexpected results.\nConsider using the `displayPrint` field in the `sx` prop instead.\nMore information about `displayPrint` on our docs: https://mui.com/system/display/#display-in-print."),(void 0!==i?function(e,t,n,a,o){let l=r.useCallback(()=>t,[t]),s=r.useMemo(()=>{if(o&&n)return()=>n(e).matches;if(null!==a){let{matches:t}=a(e);return()=>t}return l},[l,e,a,o,n]),[c,u]=r.useMemo(()=>{if(null===n)return[l,()=>()=>{}];let t=n(e);return[()=>t.matches,e=>(t.addEventListener("change",e),()=>{t.removeEventListener("change",e)})]},[l,n,e]);return i(u,c,s)}:function(e,t,n,a,l){let[s,i]=r.useState(()=>l&&n?n(e).matches:a?a(e).matches:t);return(0,o.A)(()=>{if(!n)return;let t=n(e),r=()=>{i(t.matches)};return r(),t.addEventListener("change",r),()=>{t.removeEventListener("change",r)}},[e,n]),s})(m,u,d,f,h)}}c();let u=c({themeId:n(46892).A})},20063:(e,t,n)=>{"use strict";var r=n(47260);n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}})},29767:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var r=n(12115),a=n(2821),o=n(57001),l=n(48116),s=n(16625),i=n(18159),c=n(85795),u=n(95195);function d(e){return(0,u.Ay)("MuiCard",e)}(0,c.A)("MuiCard",["root"]);var f=n(95155);let h=(0,l.Ay)(i.A,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})({overflow:"hidden"}),m=r.forwardRef(function(e,t){let n=(0,s.b)({props:e,name:"MuiCard"}),{className:r,raised:l=!1,...i}=n,c={...n,raised:l},u=(e=>{let{classes:t}=e;return(0,o.A)({root:["root"]},d,t)})(c);return(0,f.jsx)(h,{className:(0,a.A)(u.root,r),elevation:l?8:void 0,ref:t,ownerState:c,...i})})},33555:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>L});var r=n(95155),a=n(12115),o=n(85483),l=n(45365),s=n(22003),i=n(55606),c=n(38887),u=n(33567),d=n(15712),f=n(29767),h=n(94049),m=n(70690),g=n(16203),p=n(3596),v=n(20063),x=n(10308),y=n(80495),A=n(8106),w=n(24274),b=n(64269);function j(e){let{onLogLevelChange:t}=e,{t:n}=(0,w.Bd)(),[o,l]=a.useState(""),{checkSessionError:u}=(0,x.J)(),[d,f]=a.useState(""),h=a.useCallback(async e=>{null==t||t(e),l(e)},[t]),m=a.useCallback(async()=>{let e=await A.Y.GetLogLevel();if(e.error){await (null==u?void 0:u(e.error)),f(A.Y.getErrorMessage(e.error));return}null!==e.data&&void 0!==e.data&&l(e.data.log_level)},[u]);return(a.useEffect(()=>{m()},[m]),d.length>0)?(0,r.jsx)(s.A,{severity:"error",children:d}):(0,r.jsxs)(i.A,{onChange:e=>{h(e.target.value).catch(e=>{})},size:"small",value:o,children:[(0,r.jsx)(c.A,{value:"debug",children:n("Debug")}),(0,r.jsx)(c.A,{value:"info",children:n("Info")}),(0,r.jsx)(c.A,{value:"notice",children:n("Notice")}),(0,r.jsx)(c.A,{value:"warn",children:n("Warn")}),(0,r.jsx)(c.A,{value:"error",children:n("Error")}),(0,r.jsx)(c.A,{value:"fatal",children:n("Fatal")})]})}function C(){let e=a.useRef(null),t=a.useRef(null),n=a.useRef(null),[o,l]=a.useState("runlog"),[s,A]=a.useState(!1),[C,L]=a.useState(0),[k,E]=a.useState(0),[R,M]=a.useState(!0),{checkSessionError:S}=(0,x.J)(),B=(0,v.useRouter)(),U=a.useRef(null),{t:F}=(0,w.Bd)(),P=(0,u.A)(),D=(0,d.A)(P.breakpoints.up("md"));a.useEffect(()=>{let t="https:"===window.location.protocol?"wss":"ws",r="".concat(t,"://").concat(window.location.host,"/api/log/stream"),a=F("Run Log");"auditlog"===o&&(r="".concat(t,"://").concat(window.location.host,"/api/log/audit/stream"),a=F("Audit Log"));let l=new WebSocket(r);U.current=l;let s=(t,n)=>{let r={red:"\x1b[31m",green:"\x1b[32m",yellow:"\x1b[33m",blue:"\x1b[34m",magenta:"\x1b[35m",cyan:"\x1b[36m",white:"\x1b[37m"};if(n=n.replaceAll("\n",""),r[t]&&(n="".concat(r[t]).concat(n,"\x1b[0m")),e.current){let t=[n],r=t.length;e.current.appendLines(t),e.current.state.lines=e.current.state.lines.slice(-2e3),L(r)}},i=e=>{let t=new DataView(e),n=1,r="default";if(t.byteLength<2)return;let a=t.getUint8(0);if("runlog"===o){let e=t.getUint8(1);n=2;let a={0:"blue",1:"default",2:"default",3:"yellow",4:"red",5:"magenta"};a[e]&&(r=a[e])}if(0===a)for(let t of new TextDecoder().decode(e.slice(n)).split("\n"))t.length<=0||s(r,"".concat(t,"\n"))};return n.current=(e,t)=>{switch(e){case 1:l.send(new Uint8Array([1,1]).buffer);break;case 2:l.send(new Uint8Array([1,2]).buffer);break;case 3:{let e=new TextEncoder().encode(t),n=new ArrayBuffer(2+e.length),r=new DataView(n);for(let[t,n]of(r.setUint8(0,1),r.setUint8(1,3),e.entries()))r.setUint8(2+t,n);l.send(n)}}},s("white",F("Connecting to {{logtype}} stream....\n",{logtype:a})),l.onmessage=e=>{if(e.data instanceof ArrayBuffer)i(e.data);else if(e.data instanceof Blob){let t=new FileReader;t.onload=()=>{let e=t.result;e instanceof ArrayBuffer?i(e):(s("red","Invalid data type received.\r\n"),l&&l.close())},t.readAsArrayBuffer(e.data)}else s("red","Invalid data type received.\r\n"),l.close()},l.onopen=()=>{s("white",F("Connected to {{logtype}} stream.\n",{logtype:a}))},l.onerror=()=>{p.y.checkLogin().then(e=>{e.error&&S&&(S(e.error).catch(e=>{}),B.refresh())}).catch(e=>{}),s("red",F("unexpected socket close\n"))},l.onclose=e=>{s("white",F("Disconnected from {{logtype}} stream.\n",{logtype:a})),e.code>=4001&&e.code<=4999&&s("red",F("Error")+" : "+F(e.reason)+"\n")},()=>{U.current&&(U.current.close(),U.current=null)}},[F,o,S,B]);let T=async()=>{var t,n;if(null===e.current)return;let r=null!=(n=null==(t=e.current.state.lines)?void 0:t.toArray())?n:[],a=new TextDecoder,o=r.map(e=>a.decode(e)).join("\n");try{o&&await navigator.clipboard.writeText((0,b.Q)(o))}catch(t){let e=document.createElement("textarea");e.value=(0,b.Q)(o),document.body.append(e),e.select(),document.execCommand("copy"),e.remove()}};return(0,r.jsxs)(f.A,{children:[(0,r.jsx)(h.default,{sx:{marginTop:"10px",marginLeft:"20px",marginRight:"20px"},children:(0,r.jsxs)(y.A,{direction:{xs:"column",sm:"row"},spacing:2,children:[(0,r.jsxs)(i.A,{value:o,size:"small",onChange:e=>{U.current&&(U.current.close(),U.current=null),l(e.target.value)},children:[(0,r.jsx)(c.A,{value:"runlog",children:F("Run Log")}),(0,r.jsx)(c.A,{value:"auditlog",children:F("Audit Log")})]}),(0,r.jsx)(m.default,{variant:"contained",size:"small",onClick:()=>{n.current&&(A(!s),s?n.current(2,""):n.current(1,""))},color:s?"secondary":"primary",children:s?F("Resume"):F("Pause")}),(0,r.jsx)(m.default,{variant:"contained",size:"small",onClick:()=>{e.current&&(e.current.clear(),L(0))},children:F("Clear")}),(0,r.jsx)(m.default,{variant:"contained",size:"small",onClick:()=>{T()},disabled:0===C,children:F("Copy")}),"runlog"===o&&(0,r.jsx)(j,{onLogLevelChange:e=>{n.current&&n.current(3,e)}})]})}),(0,r.jsx)(h.default,{ref:t,sx:{width:"100%",height:{lg:"calc(100vh - var(--MainNav-height) - var(--Footer-height) - 110px)",xs:"calc(100vh - var(--MainNav-height) - var(--Footer-height-mobile) - 110px)"},padding:"1rem"},children:(0,r.jsx)(g.FT,{ref:e,enableSearch:D,follow:R,selectableLines:!0,external:!0,enableLineNumbers:D,onScroll:e=>{let{scrollTop:t,scrollHeight:n,clientHeight:r}=e;n-t-r<50?(M(!0),0!==k&&E(0)):(E(e=>e+1),k>3&&M(!1))},style:{height:"100%",width:"100%",fontFamily:"monospace",fontSize:"13px"}})})]})}function L(){let{t:e}=(0,w.Bd)();return a.useEffect(()=>{document.title="".concat(e("Log")," | ").concat(e("Dashboard")," | ").concat(l.$.site.name)},[e]),(0,r.jsx)(o.default,{spacing:1,height:"100%",children:(0,r.jsx)(C,{})})}},44102:(e,t,n)=>{"use strict";n.d(t,{A:()=>o}),n(12115);var r=n(10225),a=n(95155);function o(e){let{styles:t,defaultTheme:n={}}=e,o="function"==typeof t?e=>t(null==e||0===Object.keys(e).length?n:e):t;return(0,a.jsx)(r.mL,{styles:o})}},45778:(e,t,n)=>{Promise.resolve().then(n.bind(n,33555))},57019:(e,t,n)=>{"use strict";n.d(t,{default:()=>s}),n(12115);var r=n(95695),a=n(50361),o=n(46892),l=n(95155);let s=function(e){return(0,l.jsx)(r.A,{...e,defaultTheme:a.A,themeId:o.A})}},64269:(e,t,n)=>{"use strict";function r(e){return e<1024?"".concat(e,"B"):e<1048576?"".concat((e/1024).toFixed(2),"KB"):e<0x40000000?"".concat((e/1024/1024).toFixed(2),"MB"):e<0x10000000000?"".concat((e/1024/1024/1024).toFixed(2),"GB"):e<0x4000000000000?"".concat((e/1024/1024/1024/1024).toFixed(2),"TB"):"".concat((e/1024/1024/1024/1024/1024).toFixed(2),"PB")}function a(e){let t=String.fromCodePoint(27),n=RegExp("".concat(t,"\\[[\\d;]*m"),"g");return e.replaceAll(n,"")}n.d(t,{P:()=>r,Q:()=>a})},80495:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=(0,n(27263).A)()},95695:(e,t,n)=>{"use strict";n.d(t,{A:()=>i}),n(12115);var r=n(54211),a=n(44102),o=n(89505),l=n(95155);function s(e){let t=(0,r.tT)(e);return e!==t&&t.styles?(t.styles.match(/^@layer\s+[^{]*$/)||(t.styles="@layer global{".concat(t.styles,"}")),t):e}let i=function(e){let{styles:t,themeId:n,defaultTheme:r={}}=e,i=(0,o.A)(r),c=n&&i[n]||i,u="function"==typeof t?t(c):t;return c.modularCssLayers&&(u=Array.isArray(u)?u.map(e=>"function"==typeof e?s(e(c)):s(e)):s(u)),(0,l.jsx)(a.A,{styles:u})}}},e=>{e.O(0,[460,393,319,169,190,107,690,984,166,441,255,358],()=>e(e.s=45778)),_N_E=e.O()}]);